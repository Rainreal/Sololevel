<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SoloTrain Login</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="login-container">
    <h2>Enter Username</h2>
    <input type="text" id="username" class="username-input" placeholder="Username" />
    <button onclick="start()">Start</button>
  </div>

  <script>
    function start() {
      const username = document.getElementById("username").value.trim();
      if (!username) return alert("Please enter a username.");

      localStorage.setItem("username", username);

      const existingData = localStorage.getItem("data_" + username);
      if (existingData) {
        window.location.href = "Menu.html";
        return;
      }

      askGoal("Running", "runningGoal", function() {
        askGoal("Push-ups", "pushupsGoal", function() {
          askGoal("Sit-ups", "situpsGoal", function() {
            const userData = {
              level: 1,
              strength: 0,
              speed: 0,
              health: 0,
              points: 0,
              runningProgress: 0,
              pushupsProgress: 0,
              situpsProgress: 0,
              runningGoal: parseInt(localStorage.getItem("runningGoal")),
              pushupsGoal: parseInt(localStorage.getItem("pushupsGoal")),
              situpsGoal: parseInt(localStorage.getItem("situpsGoal"))
            };
            localStorage.setItem("data_" + username, JSON.stringify(userData));
            showWelcome(username);
          });
        });
      });
    }

    function askGoal(label, key, callback) {
      const dialog = document.createElement("div");
      dialog.className = "custom-dialog";
      dialog.innerHTML = `
        <p>Set your goal for ${label}</p>
        <input type="number" id="goalInput" class="username-input" placeholder="Enter number" />
        <button id="confirmBtn">OK</button>
      `;
      document.body.appendChild(dialog);

      document.getElementById("confirmBtn").onclick = function () {
        const val = parseInt(document.getElementById("goalInput").value);
        if (!val || val <= 0) return alert("Enter a valid number.");
        localStorage.setItem(key, val);
        document.body.removeChild(dialog);
        callback();
      };
    }

    function showWelcome(username) {
      const dialog = document.createElement("div");
      dialog.className = "custom-dialog";
      dialog.innerHTML = `
        <p>Welcome ${username}</p>
        <button onclick="goToMenu()">OK</button>
      `;
      document.body.appendChild(dialog);
    }

    function goToMenu() {
      window.location.href = "Menu.html";
    }
  </script>
</body>
</html>
